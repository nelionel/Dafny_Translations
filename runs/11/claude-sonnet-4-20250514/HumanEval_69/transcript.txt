======SYSTEM PROMPT======
You are a Python coding assistant. Your task is to write a Python script with the full implementation of the function described in the user prompt. The implementation should be inside a markdown code block.

======USER PROMPT======

def search(lst):
    '''
    You are given a non-empty list of positive integers. Return the greatest integer that is greater than 
    zero, and has a frequency greater than or equal to the value of the integer itself. 
    The frequency of an integer is the number of times it appears in the list.
    If no such a value exist, return -1.
    Examples:
        search([4, 1, 2, 2, 3, 1]) == 2
        search([1, 2, 2, 3, 3, 3, 4, 4, 4]) == 3
        search([5, 5, 4, 4, 4]) == -1
    '''


======THINKING======


======MODEL OUTPUT======
Looking at this problem, I need to:

1. Count the frequency of each integer in the list
2. Find integers where the frequency is greater than or equal to the value itself
3. Return the greatest such integer, or -1 if none exists

Let me trace through the examples:
- `[4, 1, 2, 2, 3, 1]`: frequencies are {4:1, 1:2, 2:2, 3:1}
  - 4 appears 1 time, but 1 < 4, so it doesn't qualify
  - 1 appears 2 times, and 2 ≥ 1, so it qualifies
  - 2 appears 2 times, and 2 ≥ 2, so it qualifies
  - 3 appears 1 time, but 1 < 3, so it doesn't qualify
  - Greatest qualifying value is 2

```python
def search(lst):
    '''
    You are given a non-empty list of positive integers. Return the greatest integer that is greater than 
    zero, and has a frequency greater than or equal to the value of the integer itself. 
    The frequency of an integer is the number of times it appears in the list.
    If no such a value exist, return -1.
    Examples:
        search([4, 1, 2, 2, 3, 1]) == 2
        search([1, 2, 2, 3, 3, 3, 4, 4, 4]) == 3
        search([5, 5, 4, 4, 4]) == -1
    '''
    # Count frequency of each number
    frequency = {}
    for num in lst:
        frequency[num] = frequency.get(num, 0) + 1
    
    # Find the greatest number where frequency >= value
    result = -1
    for value, freq in frequency.items():
        if freq >= value and value > result:
            result = value
    
    return result
```